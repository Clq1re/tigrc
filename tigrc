# === General ===
# Appearance
set main-view = id date author:email-user commit-title:graph=yes,refs=yes
set blame-view = date:default author:email-user id:yes,color line-number:yes,interval=1 text
set diff-options = -m --first-parent

# Refresh timing
set refresh-mode = periodic
set refresh-interval = 5
bind generic    r      refresh

# Search
set ignore-case = true


# === Controls ===
# Branch view
bind generic    b      view-refs

# Blame view
bind generic    <Esc>b      view-blame

# Cursor
bind generic J move-page-down
bind generic K move-page-up

# Copy commit id
bind generic `      @bash -c "echo -n '%(commit)' | pbcopy"


# === Commands ===
# Commit
bind generic C      !git commit
bind refs    C      !git commit
bind main    C      !git commit
bind generic <Esc>u !git add -p %(file)
bind generic <Esc>e !git commit --allow-empty
bind generic +      !git commit --amend --allow-empty

# Push
bind generic P      ?git push -u %(remote) %(repo:head)
bind generic <Esc>p ?git push -u -f %(remote) %(repo:head)

# Pull
bind generic U      ?git pull %(remote)

# Fetch
bind generic F      ?git fetch %(remote)
bind main    F      ?git fetch %(remote)

# Reflog
bind generic L      !sh -c "git reflog --pretty=raw | tig --pretty=raw"
bind generic _      ?git reset --hard HEAD@{"%(prompt Enter HEAD@{} number: )"}

# Reset --hard
bind main    H      ?git reset --hard %(commit)
bind refs    H      ?git reset --hard %(commit)
bind status  H      ?git checkout -- %(file)

# Checkout(move) to branch
bind main    =      ?git checkout %(branch)
bind refs    =      ?git checkout %(branch)
# 前に使用していたブランチへ戻る
bind generic <Esc>=      ?git checkout -

# Merge
bind main    M      ?git merge %(branch)
bind diff    M      ?git merge %(branch)
bind refs    M      ?git merge %(branch)
bind main    <Esc>m ?git merge %(commit)
bind diff    <Esc>m ?git merge %(commit)

# Rebase
bind main    R      ?git rebase %(branch)
bind diff    R      ?git rebase %(branch)
bind refs    R      ?git rebase %(branch)
bind main    <Esc>r ?git rebase %(commit)
bind diff    <Esc>r ?git rebase %(commit)

# Rebase -i
bind main    <Esc>i      ?git rebase -i %(branch)
bind diff    <Esc>i      ?git rebase -i %(branch)
bind refs    <Esc>i      ?git rebase -i %(branch)
bind main    i ?git rebase -i %(commit)
bind diff    i ?git rebase -i %(commit)

# Rebase options
bind generic    <Esc>y      ?git rebase --continue
bind generic    <Esc>c      ?git rebase --abort


# diff
bind main    D ?sh -c "git diff %(commit)..%(prompt Enter commit ID: ) | tig"
bind diff    D ?sh -c "git diff %(commit)..%(prompt Enter commit ID: ) | tig"

# Remove branch
bind refs    D      ?git branch -d %(branch)
bind refs    <Esc>D      ?git branch -D %(branch)

# Stash
bind generic S !git stash

# Revert
bind main    !      ?git revert %(commit)

# Cherry-pick
bind main    <Esc>k      ?git cherry-pick %(commit)
bind diff    <Esc>k      ?git cherry-pick %(commit)

# Create branch
bind main    B      ?git checkout -b "%(prompt Enter branch name: )" %(branch)
bind refs    B      ?git checkout -b "%(prompt Enter branch name: )" %(branch)
bind main    <Esc>b ?git checkout -b "%(prompt Enter branch name: )" %(commit)


# === Github ===
# Open to brouse
bind main    ;      @hub browse -- commit/%(commit)
bind blame   ;      @hub browse -- commit/%(commit)
bind diff    ;      @hub browse -- commit/%(commit)
bind tree    ;      @hub browse -- blob/%(branch)/%(file)
bind blob    ;      @hub browse -- blob/%(branch)/%(file)
bind grep    ;      @hub browse -- blob/%(branch)/%(file)

# Pull request
bind main    w      @hub browse -- compare/%(branch)?expand=1
bind diff    w      @hub browse -- compare/%(branch)?expand=1
bind refs    w      @hub browse -- compare/%(branch)?expand=1

# === Theme ===
# General colors
color default                       253         233
color cursor                        default     237
color status                        250         235
color title-focus                   default     238
color title-blur                    default     238
color delimiter                     241         default
color header                        186         236             bold
color section                       186         default
color line-number                   102         235
color id                            208         default
color date                          67          default
color author                        135         default
color mode                          166         default
color overflow                      241         default
color directory                     69          default
color file                          default     default
color file-size                     default     default
color grep.file                     166         234

# Main view colors
color graph-commit                  161         default
color main-head                     144         default         bold
color main-remote                   81          default
color main-tracked                  222         default
color main-tag                      197         default
color main-local-tag                161         default
color main-ref                      144         default

# Palette colors
color palette-0                     239         default
color palette-1                     242         default
color palette-2                     245         default
color palette-3                     248         default
color palette-4                     237         default
color palette-5                     240         default
color palette-6                     243         default
color palette-7                     246         default
color palette-8                     249         default
color palette-9                     238         default
color palette-10                    241         default
color palette-11                    244         default
color palette-12                    247         default
color palette-13                    236         default

# Status view colors
color status.header                 186         236             bold
color status.section                186         default
color stat-staged                   green       default
color stat-unstaged                 red         default
color stat-untracked                red         default

# Help view colors
color help.header                   186         236             bold
color help.section                  186         default
color help-group                    69          default
color help-action                   166         default

# Diff view colors
color "commit "                     208         234
color "Refs: "                      197         234
color "Author: "                    135         default
color "AuthorDate: "                67          default
color "Commit: "                    141         default
color "CommitDate: "                67          default
color "Merge: "                     161         default
color "---"                         67          default
color diff-index                    67          default
color diff-stat                     166         234
color diff-add-highlight            10          22
color diff-del-highlight            9           52

# Signature colors
color "gpg: "                       23          default
color "Primary key fingerprint: "   23          default
